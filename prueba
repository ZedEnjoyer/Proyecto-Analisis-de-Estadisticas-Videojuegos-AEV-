import pandas as pd

# Crear el DataFrame
df = pd.DataFrame(data)

# Normalizar las columnas
max_metacritic = df['metacritic'].max()
min_metacritic = df['metacritic'].min()
df['metacritic_normalized'] = (df['metacritic'] - min_metacritic) / (max_metacritic - min_metacritic)

max_precio = df['precio'].max()
min_precio = df['precio'].min()
df['precio_normalized'] = (df['precio'] - min_precio) / (max_precio - min_precio)

# Calcular la antigüedad (más antiguo es mejor en este caso)
max_año = df['año_de_publicacion'].max()
df['antiguedad_normalized'] = (max_año - df['año_de_publicacion']) / (max_año - df['año_de_publicacion'].min())

# Crear el índice de popularidad (ponderado)
# Asignar pesos
peso_metacritic = 0.5
peso_precio = 0.2
peso_antiguedad = 0.3

df['popularidad'] = (df['metacritic_normalized'] * peso_metacritic +
                     df['precio_normalized'] * peso_precio +
                     df['antiguedad_normalized'] * peso_antiguedad)

# Ordenar por popularidad
df_sorted = df.sort_values(by='popularidad', ascending=False)

# Mostrar los juegos con el índice de popularidad
print(df_sorted[['titulo', 'popularidad']].head(10))
